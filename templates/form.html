<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <title>ç¦æºå ‚å™¨æå¤–å€Ÿç”³è¯·</title>
    <link rel="stylesheet" href="/static/style.css">
    <style>
        body {
            font-family: "Microsoft YaHei", sans-serif;
            color: #000;
            padding: 20px;
            background-color: #f7f7f7;
        }
        h1, h3 {
            text-align: center;
            font-weight: bold;
            font-size: 28px;
            margin-bottom: 10px;
        }
        h3 { font-size: 18px; }
        form { max-width: 800px; margin: 0 auto; }
        fieldset {
            border: 2px solid #ccc;
            padding: 15px 20px;
            margin-bottom: 20px;
            border-radius: 10px;
            box-shadow: 3px 3px 10px rgba(0, 0, 0, 0.1);
            background-color: #fff;
        }
        legend { font-weight: bold; font-size: 18px; }
        .form-row {
            display: flex; align-items: center; margin-bottom: 12px;
        }
        .form-row label { flex: 0 0 160px; font-weight: bold; }
        .form-row input, .form-row select, .form-row textarea {
            flex: 1; padding: 6px; border: 2px solid #aaa; border-radius: 5px;
            font-family: "Microsoft YaHei", sans-serif;
        }
        textarea { resize: vertical; }
        .checkbox-group { display: flex; gap: 20px; flex-wrap: wrap; margin-bottom: 10px; }
        .checkbox-group label { display: flex; align-items: center; font-weight: normal; }
        .checkbox-group input[type="checkbox"] { margin-right: 6px; }
        .equipment-select-all { margin-bottom: 10px; font-weight: bold; }
        .equipment-select-all label { display: flex; align-items: center; }
        button {
            padding: 10px 20px; font-size: 16px;
            border-radius: 6px; border: none;
            background-color: #0078D7; color: white; cursor: pointer;
        }
        button:hover { background-color: #005ea6; }
        .tabs { text-align: center; margin-bottom: 20px; }
        .tabs button { margin: 0 10px; padding: 8px 16px; font-size: 14px; }
        legend::before { content: "ğŸ“Œ "; }
        /* âœ… æäº¤ç»“æœæ ·å¼ */
        #resultBox {
            max-width: 600px; margin: 30px auto; padding: 20px;
            background: #fff; border: 2px solid #ccc; border-radius: 10px;
            box-shadow: 3px 3px 10px rgba(0,0,0,0.1);
            text-align: center; font-size: 16px;
        }
        #resultBox button {
            margin-top: 15px; background: #16a34a; font-weight: bold;
        }
    </style>
</head>
<body>
    <h1>ç¦æºå ‚å™¨æå¤–å€Ÿç”³è¯·</h1>
    <h3>Masland Methodist Church èµ„è®¯å§”å‘˜ä¼š</h3>

    <div class="tabs">
        <button onclick="window.location.href='/'">ç”³è¯·è¡¨æ ¼</button>
        <button onclick="window.location.href='/status'">æŸ¥è¯¢çŠ¶æ€</button>
    </div>

    <!-- âœ… è¡¨å•æäº¤æˆåŠŸåï¼Œè¿™é‡Œä¼šæ˜¾ç¤ºæç¤ºæ¡† -->
    <div id="resultBox" style="display:none;">
        <p>âœ… æ‚¨çš„ç”³è¯·å·²æäº¤æˆåŠŸï¼</p>
        <p>è¯·å‰å¾€ã€æŸ¥è¯¢çŠ¶æ€ã€‘é¡µé¢æŸ¥çœ‹å®¡æ ¸è¿›åº¦ã€‚</p>
        <button onclick="window.location.href='/status'">å»æŸ¥è¯¢çŠ¶æ€</button>
    </div>

    <form id="mainForm" action="/submit" method="post" onsubmit="return handleSubmit()">
        <fieldset>
            <legend>ç”³è¯·äººä¿¡æ¯</legend>
            <div class="form-row"><label>å§“å *</label><input name="name" id="name" required></div>
            <div class="form-row"><label>è”ç³»ç”µè¯ *</label><input name="phone" id="phone" required></div>
            <div class="form-row"><label>ç”µå­é‚®ç®±</label><input name="email"></div>
            <div class="form-row"><label>æ‰€å±å›¢å¥‘/å°ç»„</label><input name="group"></div>
        </fieldset>

        <fieldset>
            <legend>æ´»åŠ¨ä¿¡æ¯</legend>
            <div class="form-row"><label>æ´»åŠ¨åç§° *</label><input name="event_name" required></div>
            <div class="form-row"><label>å¼€å§‹æ—¥æœŸ *</label><input type="date" name="start_date" required></div>
            <div class="form-row"><label>å¼€å§‹æ—¶é—´ *</label><input type="time" name="start_time" required></div>
            <div class="form-row"><label>ç»“æŸæ—¥æœŸ *</label><input type="date" name="end_date" required></div>
            <div class="form-row"><label>ç»“æŸæ—¶é—´ *</label><input type="time" name="end_time" required></div>
            <div class="form-row"><label>æ´»åŠ¨åœ°ç‚¹ *</label><input name="location" required></div>
            <div class="form-row"><label>æ´»åŠ¨æ€§è´¨ *</label>
                <select name="event_type" required>
                    <option value="">è¯·é€‰æ‹©æ´»åŠ¨æ€§è´¨</option>
                    <option value="å†…éƒ¨">å†…éƒ¨</option>
                    <option value="å¤–å€Ÿ">å¤–å€Ÿ</option>
                </select>
            </div>
            <div class="form-row"><label>é¢„è®¡å‚ä¸äººæ•° *</label><input name="participants" required></div>
        </fieldset>

        <fieldset>
            <legend>å™¨æéœ€æ±‚</legend>
            <div class="equipment-select-all">
                <label><input type="checkbox" id="selectAll" onchange="toggleAllEquipment(this)"> å…¨é€‰å™¨æ</label>
            </div>
            <div class="checkbox-group">
                <label><input type="checkbox" name="equipment" value="éº¦å…‹é£">éº¦å…‹é£</label>
                <label><input type="checkbox" name="equipment" value="æ‰©éŸ³å™¨">æ‰©éŸ³å™¨</label>
                <label><input type="checkbox" name="equipment" value="éŸ³å“ç³»ç»Ÿ">éŸ³å“ç³»ç»Ÿ</label>
                <label><input type="checkbox" name="equipment" value="æŠ•å½±æœº">æŠ•å½±æœº</label>
                <label><input type="checkbox" name="equipment" value="æŠ•å½±å±å¹•">æŠ•å½±å±å¹•</label>
                <label><input type="checkbox" name="equipment" value="å»¶é•¿çº¿">å»¶é•¿çº¿</label>
                <label><input type="checkbox" name="equipment" value="æ¡Œå­">æ¡Œå­</label>
                <label><input type="checkbox" name="equipment" value="æ¤…å­">æ¤…å­</label>
                <label><input type="checkbox" name="equipment" value="è®²å°">è®²å°</label>
                <label><input type="checkbox" name="equipment" value="HDMIçº¿">HDMIçº¿</label>
            </div>
            <div class="form-row">
                <label>ç‰¹æ®Šéœ€æ±‚</label>
                <textarea name="special_request"></textarea>
            </div>
        </fieldset>

        <fieldset>
            <legend>æ„Ÿæ©å¥‰çŒ®ï¼ˆå¯é€‰ï¼‰</legend>
            <label>
                <input type="checkbox" name="donation" value="yes" id="donationCheckbox" onchange="toggleDonationMethod()">
                æˆ‘æ„¿æ„ä¸ºæ­¤æ¬¡å™¨æä½¿ç”¨çŒ®ä¸Šæ„Ÿæ©å¥‰çŒ®
            </label>
            <div id="donationMethodContainer" style="margin-top: 10px; display: none;">
                <label for="donation_method" style="display: block; margin-bottom: 5px; font-weight: bold;">è¯·é€‰æ‹©å¥‰çŒ®æ–¹å¼</label>
                <select name="donation_method" id="donation_method">
                    <option value="">-- è¯·é€‰æ‹© --</option>
                    <option value="ç°é‡‘">ç°é‡‘</option>
                    <option value="é“¶è¡Œè½¬è´¦">é“¶è¡Œè½¬è´¦</option>
                </select>
            </div>
        </fieldset>

        <fieldset>
            <legend>å…¶ä»–ä¿¡æ¯</legend>
            <div class="form-row"><label>å¤‡æ³¨</label><textarea name="remarks"></textarea></div>
            <div class="form-row"><label>ç´§æ€¥è”ç³»äººå§“å</label><input name="emergency_name" id="emergency_name"></div>
            <div class="form-row"><label>ç´§æ€¥è”ç³»äººç”µè¯</label><input name="emergency_phone" id="emergency_phone"></div>
        </fieldset>

        <div style="text-align: center;">
            <button type="submit">æäº¤ç”³è¯·</button>
        </div>
    </form>

    <script>
        function toggleAllEquipment(source) {
            document.querySelectorAll('input[name="equipment"]').forEach(cb => cb.checked = source.checked);
        }
        function toggleDonationMethod() {
            const checkbox = document.getElementById('donationCheckbox');
            document.getElementById('donationMethodContainer').style.display = checkbox.checked ? 'block' : 'none';
        }
        function handleSubmit() {
            const form = document.getElementById("mainForm");
            const formData = new FormData(form);
            fetch("/submit", { method: "POST", body: formData })
                .then(res => {
                    if (res.ok) {
                        form.style.display = "none";
                        document.getElementById("resultBox").style.display = "block";
                    } else {
                        alert("æäº¤å¤±è´¥ï¼Œè¯·é‡è¯•");
                    }
                })
                .catch(() => alert("ç½‘ç»œå¼‚å¸¸"));
            return false; // é˜»æ­¢é»˜è®¤æäº¤åˆ·æ–°
        }
    </script>
</body>
</html>
