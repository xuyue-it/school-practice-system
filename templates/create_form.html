<!DOCTYPE html>
<html lang="zh">
<head>
  <meta charset="UTF-8">
  <title>创建新表单</title>
  <style>
    body {
      font-family: "Microsoft YaHei", sans-serif;
      background:#f7f9fc;
      margin:0;
      padding:20px;
    }
    .container {
      max-width:900px;
      margin:0 auto;
    }
    .card {
      background:#fff;
      border-radius:12px;
      padding:24px;
      margin-bottom:20px;
      box-shadow:0 4px 16px rgba(0,0,0,.08);
    }
    h1 {
      text-align:center;
      font-weight:900;
      margin-bottom:24px;
    }
    label {
      font-weight:700;
      display:block;
      margin:12px 0 6px;
    }
    input, select {
      width:100%;
      padding:10px;
      border:1px solid #ccc;
      border-radius:6px;
      font-family:inherit;
    }
    .question-card {
      border:1px solid #e5e7eb;
      border-radius:8px;
      padding:16px;
      margin:12px 0;
      background:#f9fafb;
      position:relative;
    }
    .remove-btn {
      position:absolute;
      top:10px;
      right:10px;
      background:#ef4444;
      color:#fff;
      border:none;
      padding:6px 10px;
      border-radius:6px;
      cursor:pointer;
    }
    .remove-btn:hover { background:#dc2626; }
    .add-btn, .submit-btn {
      margin-top:20px;
      padding:12px 20px;
      background:#2563eb;
      color:white;
      border:none;
      border-radius:8px;
      cursor:pointer;
      font-weight:700;
    }
    .add-btn:hover, .submit-btn:hover {
      background:#1d4ed8;
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="card">
      <h1>📝 创建新表单</h1>
      <form method="post" id="createForm">
        <!-- 表单名称 -->
        <label>表单名称 *</label>
        <input type="text" name="name" required placeholder="例如：活动申请表">

        <!-- 网站名 -->
        <label>网站名 *</label>
        <input type="text" name="site_name" required placeholder="例如：event2025">

        <!-- 动态问题 -->
        <h3 style="margin-top:20px;">表单问题</h3>
        <div id="questions"></div>
        <button type="button" class="add-btn" onclick="addQuestion()">➕ 添加问题</button>

        <!-- 隐藏 JSON 字段 -->
        <input type="hidden" name="schema_json" id="schema_json">

        <button type="submit" class="submit-btn">✅ 创建表单</button>
      </form>
    </div>
  </div>

  <script>
    function addQuestion() {
      const container = document.getElementById("questions");
      const qIndex = container.children.length;

      const div = document.createElement("div");
      div.className = "question-card";
      div.innerHTML = `
        <button type="button" class="remove-btn" onclick="this.parentElement.remove()">✖ 删除</button>
        <label>问题标题 *</label>
        <input type="text" class="q-label" placeholder="例如：姓名" required>
        <label>字段名 *</label>
        <input type="text" class="q-name" placeholder="例如：name" required>
        <label>题型 *</label>
        <select class="q-type">
          <option value="text">单行文本</option>
          <option value="textarea">多行文本</option>
          <option value="number">数字</option>
          <option value="date">日期</option>
          <option value="radio">单选</option>
          <option value="checkbox">多选</option>
          <option value="file">文件上传</option>
        </select>
        <label>是否必填</label>
        <select class="q-required">
          <option value="true">是</option>
          <option value="false">否</option>
        </select>
      `;
      container.appendChild(div);
    }

    document.getElementById("createForm").addEventListener("submit", function(e) {
      const questions = [];
      document.querySelectorAll(".question-card").forEach(card => {
        questions.push({
          label: card.querySelector(".q-label").value,
          name: card.querySelector(".q-name").value,
          type: card.querySelector(".q-type").value,
          required: card.querySelector(".q-required").value === "true"
        });
      });
      document.getElementById("schema_json").value = JSON.stringify({fields: questions});
    });
  </script>
</body>
</html>
