<!DOCTYPE html>
<html lang="zh">
<head>
  <meta charset="UTF-8">
  <title>åˆ›å»ºæ–°è¡¨å•</title>
  <style>
    body { font-family:"Microsoft YaHei", sans-serif; background:#f7f7f7; margin:20px; }
    .card { max-width:900px; margin:0 auto; background:#fff; padding:20px; border-radius:10px;
      box-shadow:0 4px 10px rgba(0,0,0,.08); }
    h1 { text-align:center; font-weight:900; margin-bottom:20px; }
    label { font-weight:700; display:block; margin-top:12px; }
    input, select, textarea { width:100%; padding:10px; border:1px solid #ccc; border-radius:6px; font-family:inherit; }
    button { margin-top:15px; padding:10px 18px; border:none; border-radius:8px; cursor:pointer; font-weight:700; }
    .btn-primary { background:#2563eb; color:white; }
    .btn-primary:hover { background:#1d4ed8; }
    .btn-add { background:#10b981; color:white; }
    .btn-add:hover { background:#059669; }
    .field-box { border:1px solid #ddd; padding:12px; margin-top:12px; border-radius:8px; background:#fafafa; }
    .field-box h3 { margin:0 0 10px; font-size:16px; }
    .topbar { text-align:center; margin-bottom:20px; }
    .topbar a { margin:0 8px; color:#2563eb; text-decoration:none; font-weight:600; }
  </style>
</head>
<body>
  <div class="topbar">
    <a href="/">é¦–é¡µ</a> | <a href="/admin">è¿”å›ç®¡ç†åå°</a>
  </div>
  <div class="card">
    <h1>ğŸ“ åˆ›å»ºæ–°è¡¨å•</h1>
    <form method="post" id="createForm">
      <!-- è¡¨å•åç§° -->
      <label>è¡¨å•åç§° *</label>
      <input type="text" name="name" required placeholder="ä¾‹å¦‚ï¼šæ´»åŠ¨ç”³è¯·è¡¨">

      <!-- ç½‘ç«™å -->
      <label>ç½‘ç«™å *</label>
      <input type="text" name="site_name" required placeholder="ä¾‹å¦‚ï¼ševent2025">
      <p style="font-size:13px;color:#555;">âš¡ ç®¡ç†å‘˜å’Œç”¨æˆ·é€šè¿‡ <code>/site/[ç½‘ç«™å]/...</code> è®¿é—®è¯¥ç³»ç»Ÿã€‚</p>

      <!-- å›ºå®šåŒºï¼šåŸºæœ¬ä¿¡æ¯ -->
      <div class="field-box">
        <h3>ğŸ“Œ åŸºæœ¬ä¿¡æ¯ï¼ˆç³»ç»Ÿé»˜è®¤å­—æ®µï¼‰</h3>
        <ul style="margin:0;padding-left:20px;font-size:14px;color:#444;">
          <li>å§“åï¼ˆå¿…å¡«ï¼‰</li>
          <li>é‚®ç®±ï¼ˆå¿…å¡«ï¼‰</li>
          <li>ç”µè¯</li>
          <li>æ´»åŠ¨åç§°ã€æ—¶é—´ã€åœ°ç‚¹ã€äººæ•°ç­‰</li>
        </ul>
      </div>

      <!-- åŠ¨æ€æ–°å¢å­—æ®µ -->
      <div id="customFields"></div>
      <button type="button" class="btn-add" onclick="addField()">â• æ·»åŠ æ–°å­—æ®µ</button>

      <!-- éšè— schema -->
      <input type="hidden" name="schema_json" id="schemaJson">

      <!-- æäº¤ -->
      <button type="submit" class="btn-primary">âœ… åˆ›å»ºè¡¨å•</button>
    </form>
  </div>

  <script>
    const customFields = [];

    function addField() {
      const field = {
        label: "æ–°å­—æ®µ",
        name: "field" + (customFields.length+1),
        type: "text",
        required: false
      };
      customFields.push(field);
      renderFields();
    }

    function renderFields() {
      const box = document.getElementById("customFields");
      box.innerHTML = "";
      customFields.forEach((f, idx) => {
        const div = document.createElement("div");
        div.className = "field-box";
        div.innerHTML = `
          <h3>è‡ªå®šä¹‰å­—æ®µ #${idx+1}</h3>
          <label>å­—æ®µæ ‡é¢˜</label>
          <input type="text" value="${f.label}"
            onchange="updateField(${idx}, 'label', this.value)">

          <label>å­—æ®µåç§° (è‹±æ–‡/å”¯ä¸€)</label>
          <input type="text" value="${f.name}"
            onchange="updateField(${idx}, 'name', this.value)">

          <label>ç±»å‹</label>
          <select onchange="updateField(${idx}, 'type', this.value)">
            <option value="text" ${f.type==='text'?'selected':''}>å•è¡Œæ–‡æœ¬</option>
            <option value="textarea" ${f.type==='textarea'?'selected':''}>å¤šè¡Œæ–‡æœ¬</option>
            <option value="email" ${f.type==='email'?'selected':''}>é‚®ç®±</option>
            <option value="number" ${f.type==='number'?'selected':''}>æ•°å­—</option>
            <option value="file" ${f.type==='file'?'selected':''}>æ–‡ä»¶ä¸Šä¼ </option>
            <option value="select" ${f.type==='select'?'selected':''}>ä¸‹æ‹‰é€‰æ‹©</option>
          </select>

          <label>å¿…å¡«?</label>
          <input type="checkbox" ${f.required?'checked':''}
            onchange="updateField(${idx}, 'required', this.checked)">
        `;
        box.appendChild(div);
      });
    }

    function updateField(index, key, value) {
      customFields[index][key] = value;
      renderFields();
    }

    document.getElementById("createForm").addEventListener("submit", function(e){
      const schema = { fields: customFields };
      document.getElementById("schemaJson").value = JSON.stringify(schema);
    });
  </script>
</body>
</html>
